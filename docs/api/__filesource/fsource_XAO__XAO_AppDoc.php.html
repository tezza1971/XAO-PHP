<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>File Source for XAO_AppDoc.php</title>
	<link rel="stylesheet" type="text/css" href="../media/style.css">
	<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
</head>
<body>

<table border="0" cellspacing="0" cellpadding="0" height="48" width="100%">
  <tr>
	<td class="header-top-left">
        Documentation automatically generated from the source-code
        using <a href="http://phpdocu.sourceforge.net/" title="Go to the phpDocumentor homepage.">phpDocumentor</a>.
       <div>Official Homepage: <a href="http://xao-php.sourceforge.net">xao-php.sourceforge.net</a></div>
    </td>
    <td class="header-top-right">XAO<div class="header-top-right-subpackage"></div></td>
  </tr>
  <tr><td colspan="2" class="header-line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
  <tr>
    <td colspan="2" class="header-menu">
          <a href="http://xao-php.sourceforge.net">Official homepage</a> |
          <a href="../index.html">API home</a> |
  		  <a href="../classtrees_XAO.html" class="menu">class tree: XAO</a> |
		  <a href="../elementindex_XAO.html" class="menu">index: XAO</a> |
		  <a href="../elementindex.html" class="menu">all elements</a>
    </td>
  </tr>
  <tr><td colspan="2" class="header-line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="195" class="menu">
		<div class="package-title">XAO</div>
      <b>Packages:</b><br />
  <div class="package">
              <a href="../li_XAO.html">XAO</a><br />
      	</div>
      <br />
                
                                <br />
                    </td>
    <td>
      <table cellpadding="10" cellspacing="0" width="100%" border="0"><tr><td valign="top">

<h1 align="center">Source for file XAO_AppDoc.php</h1>
<p>Documentation is available at <a href="../XAO/_classes_XAO_AppDoc_php.html">XAO_AppDoc.php</a></p>
<div class="src-code">
<pre><a name="a1"></a><br />1     <strong>&lt;?php</strong><a name="a2"></a><br />2     <font color="#009999">/**</font><a name="a3"></a><br />3     <font color="#009999">* XAO_AppDoc.php</font><a name="a4"></a><br />4     <font color="#009999">*</font><a name="a5"></a><br />5     <font color="#009999">* This script provides the class definition for AppDoc. AppDoc</font><a name="a6"></a><br />6     <font color="#009999">* creates the framework for XAO to be used in framwork mode. AppDoc inherits</font><a name="a7"></a><br />7     <font color="#009999">* DomDoc and AppDoc is intended to be inherited by the end user</font><a name="a8"></a><br />8     <font color="#009999">* - to provide the</font><a name="a9"></a><br />9     <font color="#009999">* user with an &quot;Application Object&quot; that is customised by them. See the doc</font><a name="a10"></a><br />10    <font color="#009999">* comments directly preceeding the class declaration for more information.</font><a name="a11"></a><br />11    <font color="#009999">* It is advisable to consult the tutorials shipped with XAO to obtain an</font><a name="a12"></a><br />12    <font color="#009999">* understanding of how this class is to be used.</font><a name="a13"></a><br />13    <font color="#009999">*</font><a name="a14"></a><br />14    <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@author</font></strong><font color="#009999">       Terence Kearns</font><a name="a15"></a><br />15    <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@version</font></strong><font color="#009999">      1.0 alpha</font><a name="a16"></a><br />16    <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@copyright</font></strong><font color="#009999">    Terence Kearns 2003</font><a name="a17"></a><br />17    <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@license</font></strong><font color="#009999">      LGPL (see http://www.gnu.org/licenses/lgpl.txt )</font><a name="a18"></a><br />18    <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@link</font></strong><font color="#009999">         http://xao-php.sourceforge.net</font><a name="a19"></a><br />19    <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@package</font></strong><font color="#009999">      XAO</font><a name="a20"></a><br />20    <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@see</font></strong><font color="#009999">          class DomDoc</font><a name="a21"></a><br />21    <font color="#009999">*/</font><a name="a22"></a><br />22    <a name="a23"></a><br />23    <font color="#009999">/**</font><a name="a24"></a><br />24    <font color="#009999">* Import XAO base class - DomDoc</font><a name="a25"></a><br />25    <font color="#009999">* </font><a name="a26"></a><br />26    <font color="#009999">* The AppDoc framework is extends DomDoc which extends XaoRoot.</font><a name="a27"></a><br />27    <font color="#009999">* </font><a name="a28"></a><br />28    <font color="#009999">*</font><font color="#009999"> </font><strong><font color="#009999">@import</font></strong><font color="#009999"> Transformer</font><a name="a30"></a><br />30    <font color="#009999">*/</font><a name="a31"></a><br />31    <font color="#800000">include_once</font> <font color="#ff702b">&quot;XAO_DomDoc.php&quot;</font>;<a name="a32"></a><br />32    <a name="a33"></a><br />33    <font color="#009999">/**</font><a name="a34"></a><br />34    <font color="#009999">* Import Transformer class for use by association</font><a name="a35"></a><br />35    <font color="#009999">* </font><a name="a36"></a><br />36    <font color="#009999">* This class encapsulates all XSLT functionality.</font><a name="a37"></a><br />37    <font color="#009999">* </font><a name="a38"></a><br />38    <font color="#009999">*</font><font color="#009999"> </font><strong><font color="#009999">@import</font></strong><font color="#009999"> Transformer</font><a name="a39"></a><br />39    <font color="#009999">*/</font><a name="a40"></a><br />40    <font color="#800000">include_once</font> <font color="#ff702b">&quot;XAO_Transformer.php&quot;</font>;<a name="a41"></a><br />41    <a name="a42"></a><br />42    <font color="#009999">/**</font><a name="a43"></a><br />43    <font color="#009999">* XML Application Object</font><a name="a44"></a><br />44    <font color="#009999">*</font><a name="a45"></a><br />45    <font color="#009999">* AppDoc is the &quot;Application Object&quot; part of the XAO acronym. It represents the</font><a name="a46"></a><br />46    <font color="#009999">* &quot;Application Document&quot; in the context of XML being a document. So the contents</font><a name="a47"></a><br />47    <font color="#009999">* delivered to the user by the &quot;Application&quot; is contentained in the &quot;Document&quot;</font><a name="a48"></a><br />48    <font color="#009999">* held as a DOM XML document by AppDoc::objDoc. the objDoc property is inherited</font><a name="a49"></a><br />49    <font color="#009999">* from the DomDoc class. The AppDoc class provides extra functionality on</font><a name="a50"></a><br />50    <font color="#009999">* DomDoc that is specifically needed for typical &quot;framework mode&quot; usage of XAO.</font><a name="a51"></a><br />51    <font color="#009999">* Usage of this class assumes that the user will be employing XAO in framework</font><a name="a52"></a><br />52    <font color="#009999">* mode. In short, this is the framework class for XAO. It is advisable to</font><a name="a53"></a><br />53    <font color="#009999">* consult the tutorials shipped with XAO to obtain an understanding of how this</font><a name="a54"></a><br />54    <font color="#009999">* class is intended to be used.</font><a name="a55"></a><br />55    <font color="#009999">*</font><a name="a56"></a><br />56    <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@package</font></strong><font color="#009999">      XAO</font><a name="a57"></a><br />57    <font color="#009999">*/</font><a name="a58"></a><br />58    <font color="blue">class</font> <a href="../XAO/AppDoc.html">AppDoc</a> <font color="blue">extends</font> <a href="../XAO/DomDoc.html#methodDomDoc">DomDoc</a> <strong>{</strong><a name="a59"></a><br />59        <a name="a60"></a><br />60        <font color="#009999">/**</font><a name="a61"></a><br />61    <font color="#009999">    * Cache parameters for the XSLT tranformation result</font><a name="a62"></a><br />62    <font color="#009999">    *</font><a name="a63"></a><br />63    <font color="#009999">    * In the standard XAO framework, caching can be done at two stages. The</font><a name="a64"></a><br />64    <font color="#009999">    * first is at the content generation stage which uses $arrDocCacheParams,</font><a name="a65"></a><br />65    <font color="#009999">    * the second is at the transformation results stage which uses this array.</font><a name="a66"></a><br />66    <font color="#009999">    * The array has the same requirements and is used in exactly the same way</font><a name="a67"></a><br />67    <font color="#009999">    * as the $arrDocCacheParams array. It is passed to the Transformer class</font><a name="a68"></a><br />68    <font color="#009999">    * (by $this-&gt;Transform method) which then uses CacheMan to implement it.</font><a name="a69"></a><br />69    <font color="#009999">    * Also see doc comments at XaoRoot::arrCacheParams for more info.</font><a name="a70"></a><br />70    <font color="#009999">    * </font><a name="a71"></a><br />71    <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a72"></a><br />72    <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>array </em><a name="a73"></a><br />73    <font color="#009999">    */</font><a name="a74"></a><br />74        <font color="blue">var</font> <a href="../XAO/AppDoc.html#var$arrXsltCacheParams">$arrXsltCacheParams</a> = array<strong>(</strong><strong>)</strong>;<a name="a75"></a><br />75    <a name="a76"></a><br />76        <font color="#009999">/**</font><a name="a77"></a><br />77    <font color="#009999">    * Stylesheet parameters</font><a name="a78"></a><br />78    <font color="#009999">    * </font><a name="a79"></a><br />79    <font color="#009999">    * See documentation in the Transformer class on the variable with the</font><a name="a80"></a><br />80    <font color="#009999">    * same name.</font><a name="a81"></a><br />81    <font color="#009999">    *</font><a name="a82"></a><br />82    <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a83"></a><br />83    <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>array </em><a name="a84"></a><br />84    <font color="#009999">    */</font><a name="a85"></a><br />85        <font color="blue">var</font> <a href="../XAO/AppDoc.html#var$arrXslParams">$arrXslParams</a> = array<strong>(</strong><strong>)</strong>;<a name="a86"></a><br />86        <a name="a87"></a><br />87        <font color="#009999">/**</font><a name="a88"></a><br />88    <font color="#009999">    * Storage slot for alternative payload</font><a name="a89"></a><br />89    <font color="#009999">    *</font><a name="a90"></a><br />90    <font color="#009999">    * If this variable is populated, then this is all that is sent to the UA</font><a name="a91"></a><br />91    <font color="#009999">    * via the AppDoc::Send method. If it is left empty, then the AppDoc::Send</font><a name="a92"></a><br />92    <font color="#009999">    * method will send the serialised content of DomDoc::objDoc</font><a name="a93"></a><br />93    <font color="#009999">    * This method is provided as a method of short-circuiting the default</font><a name="a94"></a><br />94    <font color="#009999">    * behavior of AppDocc::Send - thereby allowing AppDoc::Send to be the</font><a name="a95"></a><br />95    <font color="#009999">    * single/only way for which the payload is transmitted. This is very</font><a name="a96"></a><br />96    <font color="#009999">    * important because it allows XAO framework to sentralise control script</font><a name="a97"></a><br />97    <font color="#009999">    * completion and payload transmission.</font><a name="a98"></a><br />98    <font color="#009999">    * An example of where an alternate payload is needed is an XSLT</font><a name="a99"></a><br />99    <font color="#009999">    * transformation result. Other instances, where the well-formedness of a</font><a name="a100"></a><br />100   <font color="#009999">    * payload cannot be garenteed, will also require the use of this string</font><a name="a101"></a><br />101   <font color="#009999">    * variable.</font><a name="a102"></a><br />102   <font color="#009999">    * </font><a name="a103"></a><br />103   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a104"></a><br />104   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>string </em><a name="a105"></a><br />105   <font color="#009999">    */</font><a name="a106"></a><br />106       <font color="blue">var</font> <a href="../XAO/AppDoc.html#var$strAltPayload">$strAltPayload</a> = false;<a name="a107"></a><br />107   <a name="a108"></a><br />108       <font color="#009999">/**</font><a name="a109"></a><br />109   <font color="#009999">    * Debug data used when $this-&gt;blnDebug option is set to true</font><a name="a110"></a><br />110   <font color="#009999">    * </font><a name="a111"></a><br />111   <font color="#009999">    * This variable will contain extra diagnostic information as well as</font><a name="a112"></a><br />112   <font color="#009999">    * standard errors under certain circumstances. It is only outputted if</font><a name="a113"></a><br />113   <font color="#009999">    * $this-&gt;blnDebug is set.</font><a name="a114"></a><br />114   <font color="#009999">    *</font><a name="a115"></a><br />115   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   private</font><a name="a116"></a><br />116   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>string </em><a name="a117"></a><br />117   <font color="#009999">    */</font><a name="a118"></a><br />118       <font color="blue">var</font> <strong><font color="#008000">$_strDebugData</font></strong>;<a name="a119"></a><br />119   <a name="a120"></a><br />120       <font color="#009999">/**</font><a name="a121"></a><br />121   <font color="#009999">    * Force client-side XSL Transformation attempt.</font><a name="a122"></a><br />122   <font color="#009999">    *</font><a name="a123"></a><br />123   <font color="#009999">    * This causes the TransformSend() method to bypass server-side</font><a name="a124"></a><br />124   <font color="#009999">    * transformation and send the source document directly to the client. If</font><a name="a125"></a><br />125   <font color="#009999">    * the stylsheet PI is set, then the client should find it and perform it's</font><a name="a126"></a><br />126   <font color="#009999">    * own transformation.</font><a name="a127"></a><br />127   <font color="#009999">    * </font><a name="a128"></a><br />128   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a129"></a><br />129   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>boolean </em><a name="a130"></a><br />130   <font color="#009999">    */</font><a name="a131"></a><br />131       <font color="blue">var</font> <a href="../XAO/AppDoc.html#var$blnClientSideTransform">$blnClientSideTransform</a> = false;<a name="a132"></a><br />132   <a name="a133"></a><br />133       <font color="#009999">/**</font><a name="a134"></a><br />134   <font color="#009999">    * Dedicated Error output display template</font><a name="a135"></a><br />135   <font color="#009999">    *</font><a name="a136"></a><br />136   <font color="#009999">    * Under certain conditions, the availability of a dedicated error template</font><a name="a137"></a><br />137   <font color="#009999">    * will cause an exceptional condition to output the error DOM object (with</font><a name="a138"></a><br />138   <font color="#009999">    * all it's errors so far) using the same rules as $this-&gt;Send(). An example</font><a name="a139"></a><br />139   <font color="#009999">    * is the Transform object which uses it when $this-&gt;blnDebug is turned off.</font><a name="a140"></a><br />140   <font color="#009999">    * If no dedicated error stylsheet is supplied, then it behaves differently.</font><a name="a141"></a><br />141   <font color="#009999">    * It is empty by default in case it proposes any security issues.</font><a name="a142"></a><br />142   <font color="#009999">    *</font><a name="a143"></a><br />143   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a144"></a><br />144   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>uri </em><a name="a145"></a><br />145   <font color="#009999">    */</font><a name="a146"></a><br />146       <font color="blue">var</font> <a href="../XAO/AppDoc.html#var$uriErrorStyle">$uriErrorStyle</a>;<a name="a147"></a><br />147   <a name="a148"></a><br />148       <font color="#009999">/**</font><a name="a149"></a><br />149   <font color="#009999">    * Internal error style for debug output</font><a name="a150"></a><br />150   <font color="#009999">    *</font><a name="a151"></a><br />151   <font color="#009999">    * When $this-&gt;blnDebug is enabled, then the error document is appended</font><a name="a152"></a><br />152   <font color="#009999">    * using this a transformation with this error stylsheet. THIS IS NOT</font><a name="a153"></a><br />153   <font color="#009999">    * IMPLEMENTED AT THE MOMENT. IT MAY NEVER BE.</font><a name="a154"></a><br />154   <font color="#009999">    *</font><a name="a155"></a><br />155   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   private</font><a name="a156"></a><br />156   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>uri </em><a name="a157"></a><br />157   <font color="#009999">    */</font><a name="a158"></a><br />158       <font color="blue">var</font> <strong><font color="#008000">$_uriXaoErrorStyle</font></strong> = <font color="#ff702b">&quot;XAO_errors.xsl&quot;</font>;<a name="a159"></a><br />159   <a name="a160"></a><br />160       <font color="#009999">/**</font><a name="a161"></a><br />161   <font color="#009999">    * Debug option</font><a name="a162"></a><br />162   <font color="#009999">    *</font><a name="a163"></a><br />163   <font color="#009999">    * Designed to be used during development, this object will cause error</font><a name="a164"></a><br />164   <font color="#009999">    * output to be more verbose unser certain conditions. It may also be used</font><a name="a165"></a><br />165   <font color="#009999">    * by the developer to output diagnostic information at run-time. It is kept</font><a name="a166"></a><br />166   <font color="#009999">    * off by default in case it proposes any security issues.</font><a name="a167"></a><br />167   <font color="#009999">    * </font><a name="a168"></a><br />168   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a169"></a><br />169   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>boolean </em><a name="a170"></a><br />170   <font color="#009999">    */</font><a name="a171"></a><br />171       <font color="blue">var</font> <a href="../XAO/AppDoc.html#var$blnDebug">$blnDebug</a> = false;<a name="a172"></a><br />172       <a name="a173"></a><br />173       <font color="#009999">/**</font><a name="a174"></a><br />174   <font color="#009999">    * Debug option</font><a name="a175"></a><br />175   <font color="#009999">    *</font><a name="a176"></a><br />176   <font color="#009999">    * Designed to be used during development, this object will cause error</font><a name="a177"></a><br />177   <font color="#009999">    * output to be more verbose unser certain conditions. It may also be used</font><a name="a178"></a><br />178   <font color="#009999">    * by the developer to output diagnostic information at run-time. It is kept</font><a name="a179"></a><br />179   <font color="#009999">    * off by default in case it proposes any security issues.</font><a name="a180"></a><br />180   <font color="#009999">    * </font><a name="a181"></a><br />181   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a182"></a><br />182   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>boolean </em><a name="a183"></a><br />183   <font color="#009999">    */</font><a name="a184"></a><br />184       <font color="blue">var</font> <a href="../XAO/AppDoc.html#var$strForceContentType">$strForceContentType</a>;<a name="a185"></a><br />185   <a name="a186"></a><br />186       <font color="#009999">/**</font><a name="a187"></a><br />187   <font color="#009999">    * Current stylesheet URI</font><a name="a188"></a><br />188   <font color="#009999">    * </font><a name="a189"></a><br />189   <font color="#009999">    * This represents the current stylesheet that is used by this DomDoc.</font><a name="a190"></a><br />190   <font color="#009999">    * If a user overrides the $_uriStyleSheet member variable with a populated</font><a name="a191"></a><br />191   <font color="#009999">    * version, this-&gt;ndSetStylePI() is called with it in the contructor.</font><a name="a192"></a><br />192   <font color="#009999">    *</font><a name="a193"></a><br />193   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   private</font><a name="a194"></a><br />194   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>uri </em><a name="a195"></a><br />195   <font color="#009999">    */</font><a name="a196"></a><br />196       <font color="blue">var</font> <strong><font color="#008000">$_uriStyleSheet</font></strong>;<a name="a197"></a><br />197   <a name="a198"></a><br />198       <font color="#009999">/**</font><a name="a199"></a><br />199   <font color="#009999">    * Stylesheet processing instruction node</font><a name="a200"></a><br />200   <font color="#009999">    * </font><a name="a201"></a><br />201   <font color="#009999">    * This is the node object representing the stylesheet PI. It is set using</font><a name="a202"></a><br />202   <font color="#009999">    * the ndSetStylePI() method which only matains one PI node for the</font><a name="a203"></a><br />203   <font color="#009999">    * stylesheet. If a user overrides the $_uriStyleSheet member variable with</font><a name="a204"></a><br />204   <font color="#009999">    * a populated version, this ndSetStylePI() is called with it in the</font><a name="a205"></a><br />205   <font color="#009999">    * contructor.</font><a name="a206"></a><br />206   <font color="#009999">    *</font><a name="a207"></a><br />207   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a208"></a><br />208   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>node </em><a name="a209"></a><br />209   <font color="#009999">    */</font><a name="a210"></a><br />210       <font color="blue">var</font> <a href="../XAO/AppDoc.html#var$ndStylePi">$ndStylePi</a>;<a name="a211"></a><br />211   <a name="a212"></a><br />212       <font color="#009999">/**</font><a name="a213"></a><br />213   <font color="#009999">    * Which XSLT processor to use</font><a name="a214"></a><br />214   <font color="#009999">    * </font><a name="a215"></a><br />215   <font color="#009999">    * This option allows the user to choose which implemented XSLT processor</font><a name="a216"></a><br />216   <font color="#009999">    * to employ. At this stage, possible choices are:</font><a name="a217"></a><br />217   <font color="#009999">    * - SABLOTRON which uses the xslt_ functions built into PHP.</font><a name="a218"></a><br />218   <font color="#009999">    * - DOMXML which uses the experimental transformation capabilities of the</font><a name="a219"></a><br />219   <font color="#009999">    *   native PHP domxml extension itself.</font><a name="a220"></a><br />220   <font color="#009999">    * Future implementations could use external procesors which may be Java,</font><a name="a221"></a><br />221   <font color="#009999">    * Com, or command-line executables.</font><a name="a222"></a><br />222   <font color="#009999">    *</font><a name="a223"></a><br />223   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a224"></a><br />224   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>string </em><a name="a225"></a><br />225   <font color="#009999">    */</font><a name="a226"></a><br />226       <font color="blue">var</font> <a href="../XAO/AppDoc.html#var$strXsltProcessor">$strXsltProcessor</a> = <font color="#ff702b">&quot;SABLOTRON&quot;</font>; <font color="#a0a0a4">// becuase the DOMXML one is buggy</font><a name="a227"></a><br />227       <a name="a228"></a><br />228       <font color="#009999">/**</font><a name="a229"></a><br />229   <font color="#009999">    * Stylesheet native PHP DOM XML object</font><a name="a230"></a><br />230   <font color="#009999">    * </font><a name="a231"></a><br />231   <font color="#009999">    * This variable is populated if the specified stylsheet is successfully</font><a name="a232"></a><br />232   <font color="#009999">    * opened as an XML document.</font><a name="a233"></a><br />233   <font color="#009999">    *</font><a name="a234"></a><br />234   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a235"></a><br />235   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@var </font></strong><font color="#009999">     </font><em>object </em><font color="#009999"></font><a name="a236"></a><br />236   <font color="#009999">    */</font><a name="a237"></a><br />237       <font color="blue">var</font> <a href="../XAO/AppDoc.html#var$objXsl">$objXsl</a>;<a name="a238"></a><br />238       <a name="a239"></a><br />239       <font color="#009999">/**</font><a name="a240"></a><br />240   <font color="#009999">    * AppDoc constructor</font><a name="a241"></a><br />241   <font color="#009999">    *</font><a name="a242"></a><br />242   <font color="#009999">    * This method runs the parent constructor and sets up the xao namespace.</font><a name="a243"></a><br />243   <font color="#009999">    * There is no way to detect if a namespace declaration exists</font><a name="a244"></a><br />244   <font color="#009999">    * (to prevent duplicates). At the moment, one is inserted regardless!!!</font><a name="a245"></a><br />245   <font color="#009999">    * This is absolutely neccesary due to their usage by exceptions.</font><a name="a246"></a><br />246   <font color="#009999">    * WARNING::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</font><a name="a247"></a><br />247   <font color="#009999">    * THIS  MEANS THAT YOU CANNOT IMPORT EXISTING XML FILES WHICH HAVE A</font><a name="a248"></a><br />248   <font color="#009999">    * THE NAMESPACE xmlns:xao ALREADY DECLARED IN THE ROOT ELEMENT.</font><a name="a249"></a><br />249   <font color="#009999">    * The current DOMXML extension allows multiple attributes of the same name</font><a name="a250"></a><br />250   <font color="#009999">    * to be inserted (not good). It's namespace functions don't allow a</font><a name="a251"></a><br />251   <font color="#009999">    * [non-default] namespace declaration to be inserted without changing the</font><a name="a252"></a><br />252   <font color="#009999">    * prefix of the tag in context - so we're forced to use the dubious</font><a name="a253"></a><br />253   <font color="#009999">    * &quot;set_attribute()&quot; method instead.</font><a name="a254"></a><br />254   <font color="#009999">    *</font><a name="a255"></a><br />255   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>mixed </em><font color="#009999">  </font><font color="#009999">starting data</font><a name="a256"></a><br />256   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>integer </em><font color="#009999"></font><font color="#009999">how to use the staring data</font><a name="a257"></a><br />257   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@return </font></strong><font color="#009999">  </font><em>void </em><a name="a258"></a><br />258   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a259"></a><br />259   <font color="#009999">    */</font><a name="a260"></a><br />260       <font color="blue">function</font> <a href="../XAO/AppDoc.html#methodAppDoc">AppDoc</a><strong>(</strong><strong>&amp;</strong><strong><font color="#008000">$mxdStarter</font></strong><strong>,</strong><strong><font color="#008000">$intUse</font></strong> = XAO_DOC_NEW<strong>)</strong> <strong>{</strong><a name="a261"></a><br />261           <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/DomDoc.html#methodDomDoc">DomDoc</a><strong>(</strong><strong><font color="#008000">$mxdStarter</font></strong><strong>,</strong><strong><font color="#008000">$intUse</font></strong><strong>)</strong>;<a name="a262"></a><br />262                                           <font color="#a0a0a4">// automatically inject the XAO </font><a name="a263"></a><br />263                                           <font color="#a0a0a4">// namespace into the document root</font><a name="a264"></a><br />264           <font color="#a0a0a4">/* </font><a name="a265"></a><br />265   <font color="#a0a0a4">        */</font><a name="a266"></a><br />266           <a name="a267"></a><br />267           <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/is_object">is_object</a><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/DomDoc.html#var$ndRoot">ndRoot</a><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a268"></a><br />268               <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/DomDoc.html#var$ndRoot">ndRoot</a><strong>-&gt;</strong>set_attribute<strong>(</strong><a name="a269"></a><br />269                   <font color="#ff702b">&quot;xmlns:&quot;</font>.<strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/XaoRoot.html#var$strXaoNamespacePrefix">strXaoNamespacePrefix</a><strong>,</strong><a name="a270"></a><br />270                   <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a name="a271"></a><br />271   <a href="../XAO/XaoRoot.html#var$idXaoNamespace">idXaoNamespace</a>            <strong>)</strong>;<a name="a272"></a><br />272           <strong>}</strong><a name="a273"></a><br />273       <strong>}</strong><a name="a274"></a><br />274       <a name="a275"></a><br />275       <font color="#009999">/**</font><a name="a276"></a><br />276   <font color="#009999">    * Insert stylesheet processing instruction</font><a name="a277"></a><br />277   <font color="#009999">    *</font><a name="a278"></a><br />278   <font color="#009999">    * This processing instruction is used by the transform() method if a</font><a name="a279"></a><br />279   <font color="#009999">    * stylesheet URI is not specifically provided to it. This method will</font><a name="a280"></a><br />280   <font color="#009999">    * automatically be called in the constructor if the user overrides the</font><a name="a281"></a><br />281   <font color="#009999">    * $this-&gt;_uriStyleSheet member attribute. It may, however, be called at any</font><a name="a282"></a><br />282   <font color="#009999">    * time by the user. Only one xsl stylsheet PI is maintained in the</font><a name="a283"></a><br />283   <font color="#009999">    * document. If it was already set at the time of the call to this method,</font><a name="a284"></a><br />284   <font color="#009999">    * then the new stylsheet URI will _replace_ the one in the existing PI.</font><a name="a285"></a><br />285   <font color="#009999">    *</font><a name="a286"></a><br />286   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>uri </em><font color="#009999">    </font><font color="#009999">path to XSL stylesheet</font><a name="a287"></a><br />287   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>boolean </em><font color="#009999"></font><font color="#009999">Whether or not to check(parse) the file.</font><a name="a288"></a><br />288   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@return </font></strong><font color="#009999">  </font><em>bool </em><font color="#009999">   </font><font color="#009999">success</font><a name="a289"></a><br />289   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a290"></a><br />290   <font color="#009999">    */</font><a name="a291"></a><br />291       <font color="blue">function</font> <strong>&amp;</strong><a href="../XAO/AppDoc.html#methodndSetStylePI">ndSetStylePI</a><strong>(</strong><strong><font color="#008000">$uriStyleSheet</font></strong><strong>,</strong><strong><font color="#008000">$blnCheck</font></strong> = true<strong>)</strong> <strong>{</strong><a name="a292"></a><br />292           <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong>_TestForConstuctor<strong>(</strong><strong>)</strong>;<a name="a293"></a><br />293           <font color="blue">if</font><strong>(</strong><strong><font color="#008000">$blnCheck</font></strong><strong>)</strong> <strong>{</strong><a name="a294"></a><br />294               <font color="blue">if</font><strong>(</strong><strong>!</strong><a href="http://www.php.net/file_exists">file_exists</a><strong>(</strong><strong><font color="#008000">$uriStyleSheet</font></strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a295"></a><br />295                   <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#methodThrow">Throw</a><strong>(</strong><a name="a296"></a><br />296                       <font color="#ff702b">&quot;ndSetStylePI: The stylsheet you specified: &lt;strong&gt;&quot;</font><a name="a297"></a><br />297                       .<strong><font color="#008000">$uriStyleSheet</font></strong>.<font color="#ff702b">&quot;&lt;/strong&gt; does not exist. Set local file &quot;</font><a name="a298"></a><br />298                       .<font color="#ff702b">&quot;checking (parsing) to false in the second argument of &quot;</font><a name="a299"></a><br />299                       .<font color="#ff702b">&quot;DomDoc::ndSetStylePI() if the file exists remotely or &quot;</font><a name="a300"></a><br />300                       .<font color="#ff702b">&quot;you want to override checking.&quot;</font><strong>,</strong><a name="a301"></a><br />301                       <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/XaoRoot.html#methodarrSetErrFnc">arrSetErrFnc</a><strong>(</strong>__FUNCTION__<strong>,</strong>__LINE__<strong>)</strong><strong>,</strong><a name="a302"></a><br />302                       true<a name="a303"></a><br />303                   <strong>)</strong>;<a name="a304"></a><br />304                   <font color="blue">return</font> false;<a name="a305"></a><br />305               <strong>}</strong><a name="a306"></a><br />306           <strong>}</strong><a name="a307"></a><br />307           <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><strong><font color="#008000">_uriStyleSheet</font></strong> = <strong><font color="#008000">$uriStyleSheet</font></strong>;<a name="a308"></a><br />308           <strong><font color="#008000">$strPiCont</font></strong> = <font color="#ff702b">' type=&quot;text/xsl&quot; href=&quot;'</font>.<strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><strong><font color="#008000">_uriStyleSheet</font></strong>.<font color="#ff702b">'&quot;'</font>;<a name="a309"></a><br />309           <strong><font color="#008000">$strPiTarget</font></strong> = <font color="#ff702b">'xml-stylesheet'</font>;<a name="a310"></a><br />310             <strong><font color="#008000">$piStyle</font></strong> = <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/DomDoc.html#var$objDoc">objDoc</a><strong>-&gt;</strong>create_processing_instruction<strong>(</strong><a name="a311"></a><br />311               <strong><font color="#008000">$strPiTarget</font></strong><strong>,</strong> <strong><font color="#008000">$strPiCont</font></strong><a name="a312"></a><br />312           <strong>)</strong>;<a name="a313"></a><br />313           <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><strong><font color="#008000">_uriStyleSheet</font></strong> = <a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><font color="#ff702b">&quot;\\&quot;</font><strong>,</strong><font color="#ff702b">&quot;/&quot;</font><strong>,</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><strong><font color="#008000">_uriStyleSheet</font></strong><strong>)</strong>;<a name="a314"></a><br />314           <font color="blue">if</font><strong>(</strong><strong>!</strong><a href="http://www.php.net/is_object">is_object</a><strong>(</strong><strong><font color="#008000">$piStyle</font></strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a315"></a><br />315               <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#methodThrow">Throw</a><strong>(</strong><a name="a316"></a><br />316                   <font color="#ff702b">&quot;ndSetStylePI: Unable to create processing instruction using &quot;</font><a name="a317"></a><br />317                   .<font color="#ff702b">&quot;target of &quot;</font>.<strong><font color="#008000">$strPiTarget</font></strong>.<font color="#ff702b">&quot; and content of &quot;</font>.<strong><font color="#008000">$strPiCont</font></strong><strong>,</strong><a name="a318"></a><br />318                   <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/XaoRoot.html#methodarrSetErrFnc">arrSetErrFnc</a><strong>(</strong>__FUNCTION__<strong>,</strong>__LINE__<strong>)</strong><strong>,</strong>true<a name="a319"></a><br />319               <strong>)</strong>;<a name="a320"></a><br />320               <font color="blue">return</font> false;<a name="a321"></a><br />321           <strong>}</strong><a name="a322"></a><br />322           else<strong>{</strong><a name="a323"></a><br />323                                           <font color="#a0a0a4">// if one exists, replace it</font><a name="a324"></a><br />324               <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/is_object">is_object</a><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$ndStylePi">ndStylePi</a><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a325"></a><br />325                   <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$ndStylePi">ndStylePi</a><strong>-&gt;</strong>replace_node<strong>(</strong><strong><font color="#008000">$piStyle</font></strong><strong>)</strong>;<a name="a326"></a><br />326               <strong>}</strong><a name="a327"></a><br />327                                           <font color="#a0a0a4">// otherwise create it</font><a name="a328"></a><br />328               else <strong>{</strong><a name="a329"></a><br />329                   <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$ndStylePi">ndStylePi</a> = <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/DomDoc.html#var$objDoc">objDoc</a><strong>-&gt;</strong>insert_before<strong>(</strong><a name="a330"></a><br />330                       <strong><font color="#008000">$piStyle</font></strong><strong>,</strong> <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a name="a331"></a><br />331   <a href="../XAO/DomDoc.html#var$ndRoot">ndRoot</a>                <strong>)</strong>;<a name="a332"></a><br />332               <strong>}</strong><a name="a333"></a><br />333           <strong>}</strong><a name="a334"></a><br />334           <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/is_object">is_object</a><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$ndStylePi">ndStylePi</a><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a335"></a><br />335               <font color="blue">return</font> <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$ndStylePi">ndStylePi</a>;<a name="a336"></a><br />336           <strong>}</strong><a name="a337"></a><br />337           else <strong>{</strong><a name="a338"></a><br />338               <font color="blue">return</font> false;<a name="a339"></a><br />339           <strong>}</strong><a name="a340"></a><br />340       <strong>}</strong><a name="a341"></a><br />341   <a name="a342"></a><br />342       <font color="#009999">/**</font><a name="a343"></a><br />343   <font color="#009999">    * Get the absolute system location of the internal error stylsheet.</font><a name="a344"></a><br />344   <font color="#009999">    *</font><a name="a345"></a><br />345   <font color="#009999">    * This method is needed to enforce a location that is relative to</font><a name="a346"></a><br />346   <font color="#009999">    * XAO_AppDoc.php and not the last file in the call stack. See notes on</font><a name="a347"></a><br />347   <font color="#009999">    * $this-&gt;SetInternalErrorStyle();</font><a name="a348"></a><br />348   <font color="#009999">    *</font><a name="a349"></a><br />349   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@return </font></strong><font color="#009999">  </font><em>uri </em><font color="#009999">       </font><font color="#009999">Absolute path to internal error stylsheet.</font><a name="a350"></a><br />350   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a351"></a><br />351   <font color="#009999">    */</font><a name="a352"></a><br />352       <font color="blue">function</font> <a href="../XAO/AppDoc.html#methoduriGetInternalErrorStyle">uriGetInternalErrorStyle</a><strong>(</strong><strong>)</strong> <strong>{</strong><a name="a353"></a><br />353           <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong>_TestForConstuctor<strong>(</strong><strong>)</strong>;<a name="a354"></a><br />354           <font color="blue">return</font> <a href="http://www.php.net/dirname">dirname</a><strong>(</strong>__FILE__<strong>)</strong>.<font color="#ff702b">&quot;/&quot;</font>.<strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><strong><font color="#008000">_uriXaoErrorStyle</font></strong>;<a name="a355"></a><br />355       <strong>}</strong><a name="a356"></a><br />356       <a name="a357"></a><br />357       <font color="#009999">/**</font><a name="a358"></a><br />358   <font color="#009999">    * Set the name of the internal error stylsheet using in debug mode</font><a name="a359"></a><br />359   <font color="#009999">    *</font><a name="a360"></a><br />360   <font color="#009999">    * This shouldn't need to be changed. However, if it is not appropriate</font><a name="a361"></a><br />361   <font color="#009999">    * for your circumstances, you may change it. Bear in mind that the uri</font><a name="a362"></a><br />362   <font color="#009999">    * must be specified as a relative path to the physical location of the</font><a name="a363"></a><br />363   <font color="#009999">    * xao DomDoc.php file.</font><a name="a364"></a><br />364   <font color="#009999">    *</font><a name="a365"></a><br />365   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">  </font><em>uri </em><font color="#009999">    </font><font color="#009999">Relative path to internal error stylesheet</font><a name="a366"></a><br />366   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@return </font></strong><font color="#009999"> </font><em>void </em><a name="a367"></a><br />367   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">  public</font><a name="a368"></a><br />368   <font color="#009999">    */</font><a name="a369"></a><br />369       <font color="blue">function</font> <a href="../XAO/AppDoc.html#methodSetInternalErrorStyle">SetInternalErrorStyle</a><strong>(</strong><strong><font color="#008000">$uri</font></strong><strong>)</strong> <strong>{</strong><a name="a370"></a><br />370           <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><strong><font color="#008000">_uriXaoErrorStyle</font></strong> = <strong><font color="#008000">$uri</font></strong>;<a name="a371"></a><br />371       <strong>}</strong> <a name="a372"></a><br />372   <a name="a373"></a><br />373       <a name="a374"></a><br />374       <font color="#009999">/**</font><a name="a375"></a><br />375   <font color="#009999">    * Prepares $this-&gt;strAltPayload with XSLT transformation result data</font><a name="a376"></a><br />376   <font color="#009999">    *</font><a name="a377"></a><br />377   <font color="#009999">    * This function is usually called just prior to $this-&gt;Send()</font><a name="a378"></a><br />378   <font color="#009999">    * It is used when XSLT tranformations are required. It short-circuits the</font><a name="a379"></a><br />379   <font color="#009999">    * behaviour of $this-&gt;Send by populating $this-&gt;strAltPayload the results</font><a name="a380"></a><br />380   <font color="#009999">    * of the transformation. Note that this method requires a cirtain amount of</font><a name="a381"></a><br />381   <font color="#009999">    * preparation work by the user - ie. a stylsheet must be set using</font><a name="a382"></a><br />382   <font color="#009999">    * $this-&gt;ndSetStylePi()</font><a name="a383"></a><br />383   <font color="#009999">    *</font><a name="a384"></a><br />384   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@return </font></strong><font color="#009999">  </font><em>void </em><a name="a385"></a><br />385   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a386"></a><br />386   <font color="#009999">    */</font><a name="a387"></a><br />387       <font color="blue">function</font> <a href="../XAO/AppDoc.html#methodTransform">Transform</a><strong>(</strong><strong><font color="#008000">$arrCacheParams</font></strong> = null<strong>)</strong> <strong>{</strong><a name="a388"></a><br />388       <strong><font color="#008000">$arrCacheParams</font></strong> = array<strong>(</strong><strong>)</strong>;<a name="a389"></a><br />389           <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong>_TestForConstuctor<strong>(</strong><strong>)</strong>;<a name="a390"></a><br />390                                           <font color="#a0a0a4">// $this-&gt;strAltPayload is not modified</font><a name="a391"></a><br />391                                           <font color="#a0a0a4">// if the browser is to transform the</font><a name="a392"></a><br />392                                           <font color="#a0a0a4">// contents of $this-&gt;objDoc</font><a name="a393"></a><br />393           <font color="blue">if</font><strong>(</strong><strong>!</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$blnClientSideTransform">blnClientSideTransform</a><strong>)</strong> <strong>{</strong><a name="a394"></a><br />394           <a name="a395"></a><br />395                                           <font color="#a0a0a4">// Associate a new transformer</font><a name="a396"></a><br />396               <strong><font color="#008000">$objXT</font></strong> =<strong>&amp;</strong> new <a href="../XAO/Transformer.html">Transformer</a><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/DomDoc.html#var$objDoc">objDoc</a><strong>,</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><strong><font color="#008000">_uriStyleSheet</font></strong><strong>)</strong>;<a name="a397"></a><br />397                                           <font color="#a0a0a4">// pass on transform properties</font><a name="a398"></a><br />398               <strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>strXsltProcessor      = <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strXsltProcessor">strXsltProcessor</a>;<a name="a399"></a><br />399               <strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>strXaoNamespacePrefix = <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/XaoRoot.html#var$strXaoNamespacePrefix">strXaoNamespacePrefix</a>;<a name="a400"></a><br />400               <strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>arrCacheParams        = <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$arrXsltCacheParams">arrXsltCacheParams</a>;<a name="a401"></a><br />401               <strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>arrXslParams          = <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$arrXslParams">arrXslParams</a>;<a name="a402"></a><br />402               <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/count">count</a><strong>(</strong><strong><font color="#008000">$arrCacheParams</font></strong><strong>)</strong><strong>)</strong> <strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>arrCacheParams = <strong><font color="#008000">$arrCacheParams</font></strong>;<a name="a403"></a><br />403   <a name="a404"></a><br />404                                           <font color="#a0a0a4">// set up namespaces in stylsheet </font><a name="a405"></a><br />405               <font color="#a0a0a4">/* </font><a name="a406"></a><br />406   <font color="#a0a0a4">              can't do namespaces because there is no way to detect if a</font><a name="a407"></a><br />407   <font color="#a0a0a4">              namespace declaration exists (to prevent duplicates)</font><a name="a408"></a><br />408   <font color="#a0a0a4">              WARNING:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</font><a name="a409"></a><br />409   <font color="#a0a0a4">              THIS  MEANS THAT YOU HAVE TO DECLARE THE xao NAMESPACE YOURSELF</font><a name="a410"></a><br />410   <font color="#a0a0a4">              (MANUALLY) IN ALL YOUR STYLESHEET (IF YOU WANT TO USE TEMPLATES</font><a name="a411"></a><br />411   <font color="#a0a0a4">              THAT MATCH ANY XAO STUFF LIKE xao:exceptions).</font><a name="a412"></a><br />412   <font color="#a0a0a4">            */</font><a name="a413"></a><br />413               <a name="a414"></a><br />414               <font color="#a0a0a4">/*</font><a name="a415"></a><br />415   <font color="#a0a0a4">            if(isset($objXT-&gt;ndStyleRoot)) {</font><a name="a416"></a><br />416   <font color="#a0a0a4">                if(is_object($objXT-&gt;ndStyleRoot)) {</font><a name="a417"></a><br />417   <font color="#a0a0a4">                    var_dump($objXT-&gt;ndStyleRoot-&gt;attributes());</font><a name="a418"></a><br />418   <font color="#a0a0a4">                    die();</font><a name="a419"></a><br />419   <font color="#a0a0a4">                    if(</font><a name="a420"></a><br />420   <font color="#a0a0a4">                                        // to do: This detection does not work.</font><a name="a421"></a><br />421   <font color="#a0a0a4">                        !$objXT-&gt;ndStyleRoot-&gt;has_attribute(</font><a name="a422"></a><br />422   <font color="#a0a0a4">                            &quot;xmlns:&quot;.$this-&gt;strXaoNamespacePrefix</font><a name="a423"></a><br />423   <font color="#a0a0a4">                        )</font><a name="a424"></a><br />424   <font color="#a0a0a4">                    ) {</font><a name="a425"></a><br />425   <font color="#a0a0a4">                        //var_dump($objXT-&gt;objStyle-&gt;dump_node($objXT-&gt;ndStyleRoot));</font><a name="a426"></a><br />426   <font color="#a0a0a4">                        //die(&quot;&lt;br /&gt;We did not detect the namespace.&quot;);</font><a name="a427"></a><br />427   <font color="#a0a0a4">                        $objXT-&gt;ndStyleRoot-&gt;set_attribute(</font><a name="a428"></a><br />428   <font color="#a0a0a4">                            &quot;xmlns:&quot;.$this-&gt;strXaoNamespacePrefix,</font><a name="a429"></a><br />429   <font color="#a0a0a4">                            $this-&gt;idXaoNamespace</font><a name="a430"></a><br />430   <font color="#a0a0a4">                        );</font><a name="a431"></a><br />431   <font color="#a0a0a4">                    }</font><a name="a432"></a><br />432   <font color="#a0a0a4">                }</font><a name="a433"></a><br />433   <font color="#a0a0a4">            }</font><a name="a434"></a><br />434   <font color="#a0a0a4">            */</font><a name="a435"></a><br />435                                           <font color="#a0a0a4">// See if there were any problems </font><a name="a436"></a><br />436                                           <font color="#a0a0a4">// reported by the Transfromer instance</font><a name="a437"></a><br />437               <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>strError<strong>)</strong><strong>)</strong> <strong>{</strong><a name="a438"></a><br />438                       <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strAltPayload">strAltPayload</a> = <strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>strError;<a name="a439"></a><br />439                   <font color="#a0a0a4">/*</font><a name="a440"></a><br />440   <font color="#a0a0a4">                $this-&gt;Throw(</font><a name="a441"></a><br />441   <font color="#a0a0a4">                    $objXT-&gt;strError,</font><a name="a442"></a><br />442   <font color="#a0a0a4">                    $this-&gt;arrSetErrFnc(__FUNCTION__,__LINE__)</font><a name="a443"></a><br />443   <font color="#a0a0a4">                );</font><a name="a444"></a><br />444   <font color="#a0a0a4">                */</font><a name="a445"></a><br />445               <strong>}</strong><a name="a446"></a><br />446               else <strong>{</strong><a name="a447"></a><br />447                                           <font color="#a0a0a4">// perform the actual transformation and</font><a name="a448"></a><br />448                                           <font color="#a0a0a4">// pass the results to </font><a name="a449"></a><br />449                                           <font color="#a0a0a4">// $this-&gt;strAltPayload</font><a name="a450"></a><br />450                   <font color="blue">if</font><strong>(</strong><strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>Transform<strong>(</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a451"></a><br />451                       <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strAltPayload">strAltPayload</a> = <strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>strXsltResult;<a name="a452"></a><br />452                       <font color="blue">if</font><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$blnDebug">blnDebug</a><strong>)</strong> <strong>{</strong><a name="a453"></a><br />453                           <font color="blue">global</font> <strong><font color="#008000">$_GET</font></strong><a name="a454"></a><br />454                           <font color="blue">if</font><strong>(</strong>isset<strong>(</strong><strong><font color="#008000">$_GET</font></strong><strong>[</strong><font color="#ff702b">&quot;xao:XSL&quot;</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a455"></a><br />455                               <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strAltPayload">strAltPayload</a> = <a name="a456"></a><br />456                                   <strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>objStyle<strong>-&gt;</strong>dump_mem<strong>(</strong>true<strong>)</strong>;<a name="a457"></a><br />457                           <strong>}</strong><a name="a458"></a><br />458                       <strong>}</strong><a name="a459"></a><br />459                   <strong>}</strong><a name="a460"></a><br />460                   else <strong>{</strong><a name="a461"></a><br />461                       <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#methodThrow">Throw</a><strong>(</strong><a name="a462"></a><br />462                           <strong><font color="#008000">$objXT</font></strong><strong>-&gt;</strong>strError<strong>,</strong><a name="a463"></a><br />463                           <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/XaoRoot.html#methodarrSetErrFnc">arrSetErrFnc</a><strong>(</strong>__FUNCTION__<strong>,</strong>__LINE__<strong>)</strong><a name="a464"></a><br />464                       <strong>)</strong>;<a name="a465"></a><br />465                   <strong>}</strong><a name="a466"></a><br />466               <strong>}</strong><a name="a467"></a><br />467           <strong>}</strong><a name="a468"></a><br />468       <strong>}</strong><a name="a469"></a><br />469       <a name="a470"></a><br />470   <a name="a471"></a><br />471       <font color="#009999">/**</font><a name="a472"></a><br />472   <font color="#009999">    * Send the serialised XML content of this object to the client</font><a name="a473"></a><br />473   <font color="#009999">    *</font><a name="a474"></a><br />474   <font color="#009999">    * This function will emit the contents of this XML document as a string to</font><a name="a475"></a><br />475   <font color="#009999">    * the user-agent. It checks to see if the option was set to bind the error</font><a name="a476"></a><br />476   <font color="#009999">    * data [built up from usage of $this-&gt;Throw()] to the content. It also</font><a name="a477"></a><br />477   <font color="#009999">    * signals the user agent to expect text in XML format.</font><a name="a478"></a><br />478   <font color="#009999">    * When XAO is used as a framework, then some sort of send</font><a name="a479"></a><br />479   <font color="#009999">    *</font><a name="a480"></a><br />480   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>string </em><font color="#009999"></font><font color="#009999">alternate payload which will be sent</font><a name="a481"></a><br />481   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a482"></a><br />482   <font color="#009999">    */</font><a name="a483"></a><br />483       <font color="blue">function</font> <a href="../XAO/AppDoc.html#methodSend">Send</a><strong>(</strong><strong><font color="#008000">$strAlt</font></strong> = <font color="#ff702b">&quot;&quot;</font><strong>)</strong> <strong>{</strong><a name="a484"></a><br />484           <a name="a485"></a><br />485           <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong>_TestForConstuctor<strong>(</strong><strong>)</strong>;<a name="a486"></a><br />486                                           <font color="#a0a0a4">// This method may well be the last one</font><a name="a487"></a><br />487                                           <font color="#a0a0a4">// that is called by the host PHP script</font><a name="a488"></a><br />488                                           <font color="#a0a0a4">// in which case, try and collect all</font><a name="a489"></a><br />489                                           <font color="#a0a0a4">// user errors.</font><a name="a490"></a><br />490           <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong>_TrapErrors<strong>(</strong><strong>)</strong>;<a name="a491"></a><br />491           <a name="a492"></a><br />492           <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong><font color="#008000">$strAlt</font></strong><strong>)</strong><strong>)</strong> <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strAltPayload">strAltPayload</a> = <strong><font color="#008000">$strAlt</font></strong>;<a name="a493"></a><br />493                                           <font color="#a0a0a4">// If this object is running in debug</font><a name="a494"></a><br />494                                           <font color="#a0a0a4">// mode, then special XAO URL directives</font><a name="a495"></a><br />495                                           <font color="#a0a0a4">// can be acted on.</font><a name="a496"></a><br />496           <font color="blue">if</font><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$blnDebug">blnDebug</a><strong>)</strong> <strong>{</strong><a name="a497"></a><br />497               <font color="blue">global</font> <strong><font color="#008000">$_GET</font></strong><a name="a498"></a><br />498                                           <font color="#a0a0a4">// this debug directive causes a source</font><a name="a499"></a><br />499                                           <font color="#a0a0a4">// dump of the XML content regardless of</font><a name="a500"></a><br />500                                           <font color="#a0a0a4">// any alternate payload.</font><a name="a501"></a><br />501               <font color="blue">if</font><strong>(</strong>isset<strong>(</strong><strong><font color="#008000">$_GET</font></strong><strong>[</strong><font color="#ff702b">&quot;xao:XML&quot;</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a502"></a><br />502                   <font color="#a0a0a4">//$this-&gt;strAltPayload = $this-&gt;xmlGetDoc();</font><a name="a503"></a><br />503                   <a href="http://www.php.net/header">header</a><strong>(</strong><font color="#ff702b">&quot;Content-Type: text/plain&quot;</font><strong>)</strong>;<a name="a504"></a><br />504                   die<strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/DomDoc.html#methodxmlGetDoc">xmlGetDoc</a><strong>(</strong><strong>)</strong><strong>)</strong>;<a name="a505"></a><br />505               <strong>}</strong><a name="a506"></a><br />506               elseif<strong>(</strong>isset<strong>(</strong><strong><font color="#008000">$_GET</font></strong><strong>[</strong><font color="#ff702b">&quot;xao:Text&quot;</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a507"></a><br />507                   <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strForceContentType">strForceContentType</a> = <font color="#ff702b">&quot;text/plain&quot;</font>;<a name="a508"></a><br />508               <strong>}</strong><a name="a509"></a><br />509           <strong>}</strong><a name="a510"></a><br />510           <a name="a511"></a><br />511           <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strAltPayload">strAltPayload</a><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a512"></a><br />512               <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strForceContentType">strForceContentType</a><strong>)</strong><strong>)</strong><a name="a513"></a><br />513                   <a href="http://www.php.net/header">header</a><strong>(</strong><font color="#ff702b">&quot;Content-Type: &quot;</font>.<strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strForceContentType">strForceContentType</a><strong>)</strong>;<a name="a514"></a><br />514               elseif<strong>(</strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strAltPayload">strAltPayload</a><strong>,</strong>1<strong>,</strong>4<strong>)</strong> == <font color="#ff702b">&quot;?xml&quot;</font><strong>)</strong><a name="a515"></a><br />515                   <a href="http://www.php.net/header">header</a><strong>(</strong><font color="#ff702b">&quot;Content-Type: text/xml&quot;</font><strong>)</strong>;<a name="a516"></a><br />516               echo <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strAltPayload">strAltPayload</a>;<a name="a517"></a><br />517           <strong>}</strong><a name="a518"></a><br />518           else <strong>{</strong><a name="a519"></a><br />519               <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strForceContentType">strForceContentType</a><strong>)</strong><strong>)</strong><a name="a520"></a><br />520                   <a href="http://www.php.net/header">header</a><strong>(</strong><font color="#ff702b">&quot;Content-Type: &quot;</font>.<strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strForceContentType">strForceContentType</a><strong>)</strong>;<a name="a521"></a><br />521               else<a name="a522"></a><br />522                   <a href="http://www.php.net/header">header</a><strong>(</strong><font color="#ff702b">&quot;Content-Type: text/xml&quot;</font><strong>)</strong>;<a name="a523"></a><br />523               echo <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/DomDoc.html#methodxmlGetDoc">xmlGetDoc</a><strong>(</strong><strong>)</strong>;<a name="a524"></a><br />524           <strong>}</strong><a name="a525"></a><br />525       <strong>}</strong><a name="a526"></a><br />526       <a name="a527"></a><br />527       <font color="#009999">/**</font><a name="a528"></a><br />528   <font color="#009999">    * Return data that would be destined for the client (in current state)</font><a name="a529"></a><br />529   <font color="#009999">    *</font><a name="a530"></a><br />530   <font color="#009999">    * This function is specific to AppDoc and not DomDoc because of the</font><a name="a531"></a><br />531   <font color="#009999">    * strAltPayload member attribute. This function can be used by the</font><a name="a532"></a><br />532   <font color="#009999">    * RpcController class if the user bases their request class on AppDoc. For</font><a name="a533"></a><br />533   <font color="#009999">    * instnace, they may want to take advantage of AppDoc's transform</font><a name="a534"></a><br />534   <font color="#009999">    * capabilities to convernt proprietary content into another format such</font><a name="a535"></a><br />535   <font color="#009999">    * as RSS.</font><a name="a536"></a><br />536   <font color="#009999">    *</font><a name="a537"></a><br />537   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@return </font></strong><font color="#009999">  </font><em>string </em><a name="a538"></a><br />538   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a539"></a><br />539   <font color="#009999">    */</font><a name="a540"></a><br />540       <font color="blue">function</font> <a href="../XAO/AppDoc.html#methodstrGetPayload">strGetPayload</a><strong>(</strong><strong>)</strong> <strong>{</strong><a name="a541"></a><br />541           <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strAltPayload">strAltPayload</a><strong>)</strong><strong>)</strong> <font color="blue">return</font> <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#var$strAltPayload">strAltPayload</a>;<a name="a542"></a><br />542           <font color="blue">return</font> <strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/DomDoc.html#methodxmlGetDoc">xmlGetDoc</a><strong>(</strong><strong>)</strong>;<a name="a543"></a><br />543       <strong>}</strong><a name="a544"></a><br />544       <a name="a545"></a><br />545       <font color="#009999">/**</font><a name="a546"></a><br />546   <font color="#009999">    * Wrapper for parent::throw() function adding ability to abort script</font><a name="a547"></a><br />547   <font color="#009999">    *</font><a name="a548"></a><br />548   <font color="#009999">    * This function basically calls the parent function of the same name but</font><a name="a549"></a><br />549   <font color="#009999">    * also allows the caller to optionally abort the script if the last</font><a name="a550"></a><br />550   <font color="#009999">    * argument is set to true.</font><a name="a551"></a><br />551   <font color="#009999">    *</font><a name="a552"></a><br />552   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>string </em><font color="#009999"></font><font color="#009999">Main error message</font><a name="a553"></a><br />553   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>array </em><font color="#009999"></font><font color="#009999">A hash of name/vals which will be attributes in the</font><a name="a554"></a><br />554   <font color="#009999">    *</font><font color="#009999"> </font><font color="#009999">           exception tag</font><a name="a555"></a><br />555   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   public</font><a name="a556"></a><br />556   <font color="#009999">    */</font><a name="a557"></a><br />557       <font color="blue">function</font> <a href="../XAO/AppDoc.html#methodThrow">Throw</a><strong>(</strong><strong><font color="#008000">$strErrMsg</font></strong><strong>,</strong><strong><font color="#008000">$arrAttribs</font></strong> = null<strong>,</strong><strong><font color="#008000">$blnDie</font></strong> = false<strong>)</strong> <strong>{</strong><a name="a558"></a><br />558           <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong><font color="#008000">$arrAttribs</font></strong><strong>)</strong><strong>)</strong> <strong><font color="#008000">$arrAttribs</font></strong> = array<strong>(</strong><strong>)</strong>;<a name="a559"></a><br />559           parent<strong>::</strong><a href="../XAO/DomDoc.html#methodThrow">Throw</a><strong>(</strong><strong><font color="#008000">$strErrMsg</font></strong><strong>,</strong><strong><font color="#008000">$arrAttribs</font></strong><strong>)</strong>;<a name="a560"></a><br />560           <font color="blue">if</font><strong>(</strong><strong><font color="#008000">$blnDie</font></strong><strong>)</strong> die<strong>(</strong><font color="#ff702b">&quot;&lt;br /&gt;\n&quot;</font>.<strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/XaoRoot.html#var$strError">strError</a>.<strong><font color="#008000">$this</font></strong><strong>-&gt;</strong><a href="../XAO/XaoRoot.html#var$strDebugData">strDebugData</a><strong>)</strong>;<a name="a561"></a><br />561       <strong>}</strong> <a name="a562"></a><br />562   <a name="a563"></a><br />563       <font color="#009999">/**</font><a name="a564"></a><br />564   <font color="#009999">    * Try to trap any user-triggered errors for handling by DomDoc::throw</font><a name="a565"></a><br />565   <font color="#009999">    *</font><a name="a566"></a><br />566   <font color="#009999">    * This function is a partial solution for general PHP error handling based</font><a name="a567"></a><br />567   <font color="#009999">    * on PHP's own error management capabilities. Unfortunately, PHP will only</font><a name="a568"></a><br />568   <font color="#009999">    * allow your error handling call-back function to process what it calls</font><a name="a569"></a><br />569   <font color="#009999">    * &quot;USER&quot; errors - errors that are triggered using the trigger_error() or</font><a name="a570"></a><br />570   <font color="#009999">    * user_error() functions. PHP does not let you manage PHP generated errors.</font><a name="a571"></a><br />571   <font color="#009999">    * Furthermore, this function is only useful when people use XAO in framework</font><a name="a572"></a><br />572   <font color="#009999">    * mode and neccesarily name their Application document object $objAppDoc</font><a name="a573"></a><br />573   <font color="#009999">    *</font><a name="a574"></a><br />574   <font color="#009999">    *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   private</font><a name="a575"></a><br />575   <font color="#009999">    */</font><a name="a576"></a><br />576       <font color="blue">function</font> _TrapErrors<strong>(</strong><strong>)</strong> <strong>{</strong><a name="a577"></a><br />577                                           <font color="#a0a0a4">// this method is only useful if you </font><a name="a578"></a><br />578                                           <font color="#a0a0a4">// name your Application document object</font><a name="a579"></a><br />579                                           <font color="#a0a0a4">// $objAppDoc</font><a name="a580"></a><br />580           <font color="blue">global</font> <strong><font color="#008000">$objAppDoc</font></strong><a name="a581"></a><br />581                                           <font color="#a0a0a4">// custom error handler cannot be set </font><a name="a582"></a><br />582                                           <font color="#a0a0a4">// from within an object. It also needs</font><a name="a583"></a><br />583                                           <font color="#a0a0a4">// the handler to be a router to the</font><a name="a584"></a><br />584                                           <font color="#a0a0a4">// application object (if found in the</font><a name="a585"></a><br />585                                           <font color="#a0a0a4">// global scope).</font><a name="a586"></a><br />586               <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/is_object">is_object</a><strong>(</strong><strong><font color="#008000">$objAppDoc</font></strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a587"></a><br />587                   <a href="http://www.php.net/set_error_handler">set_error_handler</a><strong>(</strong><font color="#ff702b">&quot;ErrorRouter&quot;</font><strong>)</strong>;<a name="a588"></a><br />588               <strong>}</strong><a name="a589"></a><br />589       <strong>}</strong><a name="a590"></a><br />590   <strong>}</strong> <font color="#a0a0a4">// END CLASS</font><a name="a591"></a><br />591   <a name="a592"></a><br />592   <a name="a593"></a><br />593   <font color="#009999">/**</font><a name="a594"></a><br />594   <font color="#009999">* Custom error handler function</font><a name="a595"></a><br />595   <font color="#009999">*</font><a name="a596"></a><br />596   <font color="#009999">* Normally everything in XAO adheres strictly to being coded as object oriented,</font><a name="a597"></a><br />597   <font color="#009999">* however, since that's not how PHP was designed, exceptions have to be made.</font><a name="a598"></a><br />598   <font color="#009999">* The following function is referred to by the AppDoc::_TrapErrors() method</font><a name="a599"></a><br />599   <font color="#009999">* as specified by the set_error_handler(&quot;ErrorRouter&quot;) function. The call-back</font><a name="a600"></a><br />600   <font color="#009999">* specified in set_error_handler() is not able to exist inside a class</font><a name="a601"></a><br />601   <font color="#009999">* definition if it is to work as intended with PHPs custom error handling. It</font><a name="a602"></a><br />602   <font color="#009999">* is only effective if the user instantiates $objAppDoc as part of a</font><a name="a603"></a><br />603   <font color="#009999">* conventional XAO methodology.</font><a name="a604"></a><br />604   <font color="#009999">*</font><a name="a605"></a><br />605   <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>string </em><font color="#009999"> </font><font color="#009999">error code</font><a name="a606"></a><br />606   <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>string </em><font color="#009999"> </font><font color="#009999">error message</font><a name="a607"></a><br />607   <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>string </em><font color="#009999"> </font><font color="#009999">error location of context script</font><a name="a608"></a><br />608   <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>integer </em><font color="#009999"></font><font color="#009999">line number of context script</font><a name="a609"></a><br />609   <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999">   </font><em>array </em><font color="#009999">  </font><font color="#009999">any arguments involved in an errored function</font><a name="a610"></a><br />610   <font color="#009999">*</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999">   private</font><a name="a611"></a><br />611   <font color="#009999">*/</font><a name="a612"></a><br />612   <font color="blue">function</font> ErrorRouter<strong>(</strong><strong><font color="#008000">$strErrCode</font></strong><strong>,</strong> <strong><font color="#008000">$strErrMsg</font></strong><strong>,</strong> <strong><font color="#008000">$uriContext</font></strong><strong>,</strong> <strong><font color="#008000">$intLine</font></strong><strong>,</strong> <strong><font color="#008000">$mxdArgs</font></strong><strong>)</strong> <strong>{</strong><a name="a613"></a><br />613                                           <font color="#a0a0a4">// This is the sort of nonsense required</font><a name="a614"></a><br />614                                           <font color="#a0a0a4">// by a non-oo approach.</font><a name="a615"></a><br />615       <font color="blue">global</font> <strong><font color="#008000">$objAppDoc</font></strong><a name="a616"></a><br />616       <strong><font color="#008000">$arrAttribs</font></strong> = array<strong>(</strong><a name="a617"></a><br />617           <font color="#ff702b">&quot;code&quot;</font>    =&gt; <strong><font color="#008000">$strErrCode</font></strong><strong>,</strong><a name="a618"></a><br />618           <font color="#ff702b">&quot;file&quot;</font>    =&gt; <strong><font color="#008000">$uriContext</font></strong><strong>,</strong><a name="a619"></a><br />619           <font color="#ff702b">&quot;line&quot;</font>    =&gt; <strong><font color="#008000">$intLine</font></strong><strong>,</strong><a name="a620"></a><br />620           <font color="#ff702b">&quot;phpArgs&quot;</font> =&gt; <a href="http://www.php.net/serialize">serialize</a><strong>(</strong><strong><font color="#008000">$mxdArgs</font></strong><strong>)</strong><a name="a621"></a><br />621       <strong>)</strong>;<a name="a622"></a><br />622                                           <font color="#a0a0a4">// ATM, error reports require an XML</font><a name="a623"></a><br />623                                           <font color="#a0a0a4">// aware user-agent.</font><a name="a624"></a><br />624       <strong><font color="#008000">$objAppDoc</font></strong><strong>-&gt;</strong><a href="../XAO/AppDoc.html#methodThrow">Throw</a><strong>(</strong><font color="#ff702b">&quot;PHP ERROR: &quot;</font>.<strong><font color="#008000">$strErrMsg</font></strong><strong>,</strong><strong><font color="#008000">$arrAttribs</font></strong><strong>)</strong>;<a name="a625"></a><br />625   <strong>}</strong><a name="a626"></a><br />626   <strong>?&gt;</strong></pre>
</div>
        <div class="credit">
		    <hr class="separator" />
		    Documentation generated on Fri,  3 Oct 2003 19:09:32 +1000 by <a href="http://www.phpdoc.org">phpDocumentor 1.2.2</a>
	      </div>
      </td></tr></table>
    </td>
  </tr>
</table>

</body>
</html>